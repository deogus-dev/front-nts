"use strict";(self["webpackChunkfrontend_nts"]=self["webpackChunkfrontend_nts"]||[]).push([[188],{4188:function(t,a,e){e.r(a),e.d(a,{default:function(){return Y}});var n=function(){var t=this,a=t._self._c;return a("div",{staticClass:"card h-100 border-0 py-2 container-md"},[a("div",{staticClass:"card-header border-0 row m-0 px-0 py-3 bg-transparent"},[t._m(0),a("div",{staticClass:"col-7 text-start"},[a("h5",[a("strong",[t._v(t._s(t.getName))]),t._v("님"),a("br"),t._v("환영합니다. ")])]),a("div",{staticClass:"col-3 text-start"},[a("div",{staticClass:"form-check form-switch"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.attendInfo[1].attendCode,expression:"attendInfo[1].attendCode"}],staticClass:"form-check-input",attrs:{type:"checkbox",role:"switch",id:"flexSwitchCheckChecked","true-value":"AT07","false-value":"AT01",disabled:"out"===t.attendStatus||"end"===t.attendStatus},domProps:{checked:Array.isArray(t.attendInfo[1].attendCode)?t._i(t.attendInfo[1].attendCode,null)>-1:t._q(t.attendInfo[1].attendCode,"AT07")},on:{change:[function(a){var e=t.attendInfo[1].attendCode,n=a.target,s=n.checked?"AT07":"AT01";if(Array.isArray(e)){var o=null,i=t._i(e,o);n.checked?i<0&&t.$set(t.attendInfo[1],"attendCode",e.concat([o])):i>-1&&t.$set(t.attendInfo[1],"attendCode",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.attendInfo[1],"attendCode",s)},function(a){return t.toggle()}]}}),a("select",{directives:[{name:"model",rawName:"v-model",value:t.attendInfo[1].attendCode,expression:"attendInfo[1].attendCode"}],staticClass:"border-0",staticStyle:{appearance:"none"},attrs:{for:"flexSwitchCheckChecked",disabled:""},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.attendInfo[1],"attendCode",a.target.multiple?e:e[0])}}},[a("option",{attrs:{value:"AT01"}},[t._v("정상근무")]),a("option",{attrs:{value:"AT07"}},[t._v("재택근무")])])])])]),a("div",{staticClass:"card-body h-100 border-0 shadow"},["in"===t.attendStatus?a("day-component"):"out"===t.attendStatus?a("working-component",{attrs:{inTime:t.attendInfo[1].inTime}}):a("end-component")],1),t._m(1),"end"!==t.attendStatus?a("div",{staticClass:"card-body px-0 py-5 border-0"},[a("button",{staticClass:"btn w-100 py-3 my-1 bg-gradient",class:"in"===t.attendStatus&&t.locationInfo.circleIn||"out"===t.attendStatus||"AT07"===t.attendInfo[1].attendCode?"btn-success":"btn-secondary",on:{click:function(a){return t.attend(t.attendStatus)}}},[t._v(" "+t._s("in"===t.attendStatus?"출근하기":"퇴근하기")+" ")]),a("router-link",{staticClass:"btn w-100 py-3 my-1 btn-secondary bg-gradient opacity-50",staticStyle:{"--bs-bg-opacity":"0.5"},attrs:{to:{name:"page2"}}},[t._v(" 나의 출퇴근 기록 ")])],1):t._e(),a("div",{staticClass:"offcanvas offcanvas-bottom h-100",attrs:{tabindex:"-1",id:"offcanvasBottom","aria-labelledby":"offcanvasBottomLabel"}},[t._m(2),a("div",{staticClass:"offcanvas-body small h-100 p-0"},[a("kakao-map",{staticClass:"h-100",attrs:{locationInfo:t.locationInfo},on:{setLocationInfo:t.setLocationInfo}}),a("button",{staticClass:"btn fixed-bottom mb-5 mx-5 bg-gradient py-3",class:"in"===t.attendStatus&&t.locationInfo.circleIn||"out"===t.attendStatus||"AT07"===t.attendInfo[1].attendCode?"btn-success":"btn-secondary",on:{click:function(a){return t.attend()}}},[t._v(" "+t._s("in"===t.attendStatus?"출근하기":"퇴근하기")+" ")])],1)])])},s=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"col-2 text-start"},[a("button",{staticClass:"btn h-100 border rounded-circle"},[a("i",{staticClass:"bi-person h-100"})])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"card-body border-0 p-0"},[a("button",{staticClass:"btn bg-gradient w-100 shadow",attrs:{type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasBottom","aria-controls":"offcanvasBottom"}},[t._v(" 내 위치보기 ")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"offcanvas-header"},[a("h5",{staticClass:"offcanvas-title",attrs:{id:"offcanvasBottomLabel"}},[t._v(" Nine to Six Map ")]),a("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"offcanvas","aria-label":"Close"}})])}],o=e(629),i=function(){var t=this;t._self._c;return t._m(0)},r=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"h-100"},[a("div",{staticClass:"h-100",attrs:{id:"map"}})])}],l=(e(1703),{props:["locationInfo"],data(){return{interval:null,time:null,map:null,marker:null,position:{lat:37.51082,lng:127.02928},circle:[]}},created(){"geolocation"in navigator&&this.getCurPos()},mounted(){if(window.kakao&&window.kakao.maps)this.initMap();else{const t=document.createElement("script");t.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=8425cb2bc152a90c5eae2c00e29f04dc",t.addEventListener("load",(()=>{kakao.maps.load(this.initMap)})),document.head.appendChild(t)}},watch:{position:{handler:function(){if(this.map){var t=new kakao.maps.LatLng(this.position.lat,this.position.lng);this.map.setCenter(t),this.marker.setPosition(t),this.posCheck()}},deep:!0}},beforeDestroy(){navigator.geolocation.clearWatch(this.interval)},destroyed(){},methods:{async initMap(){var t=document.getElementById("map"),a={center:new kakao.maps.LatLng(this.position.lat,this.position.lng),level:4};this.map=new kakao.maps.Map(t,a),this.marker=new kakao.maps.Marker({position:this.map.getCenter()}),this.marker.setMap(this.map);const e=await this.$axios.get("/company-locations");200===e.status&&(e.data.forEach((t=>{this.circle.push(new kakao.maps.Circle({center:new kakao.maps.LatLng(t.latitude,t.longitude),fillColor:t.locationCode}))})),this.circle.forEach((t=>{t.setMap(this.map)})),this.posCheck()),this.map.setDraggable(!0),kakao.maps.event.addListener(this.map,"click",(t=>{var a=t.latLng;this.marker.setPosition(a),this.position.lat=a.getLat(),this.position.lng=a.getLng()}))},getCurPos(){navigator.geolocation&&(this.interval=navigator.geolocation.watchPosition((t=>{this.position.lat=t.coords.latitude,this.position.lng=t.coords.longitude}),(t=>{console.log("[navigator error] : ",t.message)}),{enableHighAccuracy:!1}))},posCheck(){try{this.circle.forEach((t=>{if(this.position.lng>t.getBounds().ha&&this.position.lat>t.getBounds().qa&&this.position.lng<t.getBounds().oa&&this.position.lat<t.getBounds().pa)throw this.$emit("setLocationInfo",{circleIn:!0,locCode:t.Eb.fillColor}),new Error("stop loop");this.$emit("setLocationInfo",{circleIn:!1,locCode:null})}))}catch(t){}}}}),c=l,d=e(3736),u=(0,d.Z)(c,i,r,!1,null,null,null),m=u.exports,h=function(){var t=this,a=t._self._c;return a("div",{staticClass:"row row-cols-5 m-0 align-items-center h-100"},[a("div",{staticClass:"col p-0 fw-light"},[a("h4",[t._v(t._s(t.getDay(-2)))])]),a("div",{staticClass:"col p-0 fw-light"},[a("h4",[t._v(t._s(t.getDay(-1)))])]),a("div",{staticClass:"col p-0 fw-bold"},[a("h4",[t._v(t._s(t.getDay(0)))])]),a("div",{staticClass:"col p-0 fw-light"},[a("h4",[t._v(t._s(t.getDay(1)))])]),a("div",{staticClass:"col p-0 fw-light"},[a("h4",[t._v(t._s(t.getDay(2)))])]),a("div",{staticClass:"col-12"},[a("h2",{staticClass:"fw-bold"},[t._v(t._s(t.time))])])])},f=[],p={data(){return{interval:null,time:null}},created(){setInterval(this.getTime,1e3)},computed:{getDay(){return t=>this.$moment().add("days",t).format("DD\n일")}},methods:{getTime(){this.time=this.$moment().format("HH:mm:ss")}}},v=p,g=(0,d.Z)(v,h,f,!1,null,null,null),C=g.exports,b=function(){var t=this,a=t._self._c;return a("div",{staticClass:"row m-0 align-items-center h-100"},[a("div",{staticClass:"col-12"},[t._v(" 출근시간 : "+t._s(t._f("timeFormat")(t.inTime))+" ")]),a("div",{staticClass:"col-12"},[t._v(t._s(t.workText))]),a("div",{staticClass:"col-12"},[a("div",{staticClass:"progress"},[a("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated",style:"width: "+t.workHour/8*100+"%",attrs:{role:"progressbar","aria-label":"Animated striped example","aria-valuenow":"75","aria-valuemin":"0","aria-valuemax":"100"}})])])])},k=[],_={props:["inTime"],data(){return{workHour:null,workText:null}},created(){setInterval(this.workingTime,1e4),this.workingTime()},filters:{timeFormat:function(t){return t.substring(0,2)+":"+t.substring(2,4)+":"+t.substring(4,6)}},methods:{workingTime(){const t=this.$moment(this.$moment(),"YYYYMMDDHHmmss"),a=this.$moment(this.$moment().format("YYYYMMDD")+this.inTime.substring(0,2)+this.inTime.substring(2,4)+this.inTime.substring(4,6),"YYYYMMDDHHmmss"),e=this.$moment.utc(t.diff(a));this.workHour=e.format("H"),this.workText=e.format("HH시간 mm분째 근무중")}}},I=_,w=(0,d.Z)(I,b,k,!1,null,null,null),y=w.exports,T=function(){var t=this,a=t._self._c;return a("div",[t._v("근무가 종료되었습니다. 수고하셨습니다.")])},x=[],D={},S=(0,d.Z)(D,T,x,!1,null,null,null),$=S.exports,M={components:{kakaoMap:m,dayComponent:C,workingComponent:y,endComponent:$},data(){return{attendInfo:[{},{}],locationInfo:{circleIn:!1,locCode:null}}},async created(){try{const t=await this.$axios.get("/attends");200===t.status&&(this.attendInfo=t.data.attendList,this.attendInfo[1].attendCode||(this.attendInfo[1].attendCode="AT01"),this.attendInfo[1].attendDate||(this.attendInfo[1].attendDate=this.$moment().format("YYMMDD")))}catch(t){}},computed:{...(0,o.Se)(["getName"]),isVisible(){switch(this.attendStatus){case"in":if(!this.attendInfo[1].inTime)return!0;break;case"out":if(this.attendInfo[1].inTime&&!this.attendInfo[1].outTime)return!0;break;case"end":break}return!1},attendStatus(){return this.attendInfo[0].outTime||"AT08"!==this.attendInfo[0].attendCode?this.attendInfo[1].inTime&&this.attendInfo[1].outTime?"end":this.attendInfo[1].inTime?"out":"in":"out"}},methods:{setLocationInfo(t){this.locationInfo.circleIn=t.circleIn,this.locationInfo.locCode=t.locCode},async attend(){try{if(!this.attendValid())return!1;let a={attendDate:this.$moment().format("YYMMDD"),attendCode:this.attendInfo[1].attendCode};"in"===this.attendStatus?(a.inTime=this.$moment().format("HHmmss"),a.locationCode=this.locationInfo.locCode):"out"===this.attendStatus&&(a.outTime=this.$moment().format("HHmmss"));const e=await this.$axios.post("/attend",a);if(200===e.status){var t=null;"in"===this.attendStatus?t="출근":"out"===this.attendStatus&&(t="퇴근"),alert(t+"이 확인되었습니다!"),this.$router.go()}}catch(a){}},attendValid(){return!("in"===this.attendStatus&&"AT07"!==this.attendInfo[1].attendCode&&!this.locationInfo.circleIn)||(alert("현재 위치가 회사 근처가 아닙니다 위치를 확인해주세요!"),!1)},async toggle(){const t=await this.$axios.post("/attend",{attendDate:this.$moment().format("YYMMDD"),attendCode:this.attendInfo[1].attendCode});200===t.status&&console.log("succeed!")}}},A=M,L=(0,d.Z)(A,n,s,!1,null,null,null),Y=L.exports}}]);
//# sourceMappingURL=188.6cac5e94.js.map