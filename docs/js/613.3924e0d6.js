"use strict";(self["webpackChunkfrontend_nts"]=self["webpackChunkfrontend_nts"]||[]).push([[613],{4625:function(t,a,o){o.d(a,{Z:function(){return r}});var s=function(){var t=this;t._self._c;return t._m(0)},i=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"h-100"},[a("div",{staticClass:"h-100",attrs:{id:"map"}})])}],n=(o(1703),{props:["locationInfo"],data(){return{interval:null,time:null,map:null,marker:null,compLoc:[],position:{lat:37.51082,lng:127.02928},circle:[]}},created(){"geolocation"in navigator&&this.getCurPos()},mounted(){if(window.kakao&&window.kakao.maps)this.initMap();else{const t=document.createElement("script");t.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=8425cb2bc152a90c5eae2c00e29f04dc",t.addEventListener("load",(()=>{kakao.maps.load(this.initMap)})),document.head.appendChild(t)}},watch:{position:{handler:function(){if(this.map){var t=new kakao.maps.LatLng(this.position.lat,this.position.lng);this.map.setCenter(t),this.marker.setPosition(t),this.posCheck()}},deep:!0},compLoc:{handler:function(){this.initMap()},deep:!0}},beforeDestroy(){navigator.geolocation.clearWatch(this.interval)},destroyed(){},methods:{async initMap(){var t=document.getElementById("map"),a={center:new kakao.maps.LatLng(this.position.lat,this.position.lng),level:4};this.map=new kakao.maps.Map(t,a),this.marker=new kakao.maps.Marker({position:this.map.getCenter()}),this.marker.setMap(this.map);const o=await this.$axios.get("/company-locations",{params:{email:"it1713@gsitm.com"}});200===o.status&&(console.log(o.data),o.data.forEach((t=>{this.circle.push(new kakao.maps.Circle({center:new kakao.maps.LatLng(t.latitude,t.longitude),fillColor:t.locationCode}))})),this.circle.forEach((t=>{t.setMap(this.map)})),this.posCheck()),this.map.setDraggable(!0),kakao.maps.event.addListener(this.map,"click",(t=>{var a=t.latLng;this.marker.setPosition(a),this.position.lat=a.getLat(),this.position.lng=a.getLng()}))},getCurPos(){navigator.geolocation&&(this.interval=navigator.geolocation.watchPosition((t=>{this.position.lat=t.coords.latitude,this.position.lng=t.coords.longitude}),(t=>{console.log("error! ",t.message)}),{enableHighAccuracy:!1}))},posCheck(){try{console.log(this.circle),this.circle.forEach((t=>{if(this.position.lng>t.getBounds().ha&&this.position.lat>t.getBounds().qa&&this.position.lng<t.getBounds().oa&&this.position.lat<t.getBounds().pa)throw this.$emit("setLocationInfo",{circleIn:!0,locCode:t.Eb.fillColor}),new Error("stop loop");this.$emit("setLocationInfo",{circleIn:!1,locCode:null})}))}catch(t){}}}}),e=n,c=o(3736),l=(0,c.Z)(e,s,i,!1,null,null,null),r=l.exports},2613:function(t,a,o){o.r(a),o.d(a,{default:function(){return d}});var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"card h-100 border-0 py-2 container-md"},[t._m(0),a("div",{staticClass:"card-body h-25 border-0 shadow"},[a("div",{staticClass:"row row-cols-5 m-0 align-items-center h-100"},[a("div",{staticClass:"col p-0 fw-light"},[a("h4",[t._v(t._s(t.getDay(-2)))])]),a("div",{staticClass:"col p-0 fw-light"},[a("h4",[t._v(t._s(t.getDay(-1)))])]),a("div",{staticClass:"col p-0 fw-bold"},[a("h4",[t._v(t._s(t.getDay(0)))])]),a("div",{staticClass:"col p-0 fw-light"},[a("h4",[t._v(t._s(t.getDay(1)))])]),a("div",{staticClass:"col p-0 fw-light"},[a("h4",[t._v(t._s(t.getDay(2)))])])])]),a("div",{staticClass:"card-body h-25 border-0"},[a("h2",{staticClass:"fw-bold"},[t._v(t._s(t.getTime))])]),t._m(1),a("div",{staticClass:"card-body p-0 h-100 border-0"},[a("button",{staticClass:"btn w-100 py-3 my-1 bg-gradient",class:t.locationInfo.circleIn?"btn-success":"btn-secondary",on:{click:t.attend}},[t._v(" "+t._s("in"===t.attendType?"출근하기":"퇴근하기")+" ")]),a("button",{staticClass:"btn w-100 py-3 my-1 btn-secondary bg-gradient opacity-50",staticStyle:{"--bs-bg-opacity":"0.5"}},[t._v(" 나의 출퇴근 기록 ")])]),a("div",{staticClass:"offcanvas offcanvas-bottom h-100",attrs:{tabindex:"-1",id:"offcanvasBottom","aria-labelledby":"offcanvasBottomLabel"}},[t._m(2),a("div",{staticClass:"offcanvas-body small h-100 p-0"},[a("kakao-map",{staticClass:"h-100",attrs:{locationInfo:t.locationInfo},on:{setLocationInfo:t.setLocationInfo}}),a("button",{staticClass:"btn fixed-bottom mb-5 mx-5 bg-gradient py-3",class:t.locationInfo.circleIn?"btn-success":"btn-secondary",on:{click:function(a){return t.attend(t.attendType)}}},[t._v(" "+t._s("in"===t.attendType?"출근하기":"퇴근하기")+" ")])],1)])])},i=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"card-header border-0 row m-0 px-0 py-3 bg-transparent"},[a("div",{staticClass:"col-2 text-start"},[a("button",{staticClass:"btn h-100 border rounded-circle"},[a("i",{staticClass:"bi-person h-100"})])]),a("div",{staticClass:"col-10 text-start"},[a("h5",[a("strong",[t._v("김지각")]),t._v("님"),a("br"),t._v("환영합니다.")])])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"card-body border-0 p-0"},[a("button",{staticClass:"btn bg-gradient w-100 shadow",attrs:{type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasBottom","aria-controls":"offcanvasBottom"}},[t._v(" 내 위치보기 ")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"offcanvas-header"},[a("h5",{staticClass:"offcanvas-title",attrs:{id:"offcanvasBottomLabel"}},[t._v(" Nine to Six Map ")]),a("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"offcanvas","aria-label":"Close"}})])}],n=o(4625),e={components:{kakaoMap:n.Z},data(){return{attendType:"in",attendInfo:[{},{}],locationInfo:{circleIn:!1,locCode:null}}},async created(){try{const t=await this.$axios.get("/attends");if(200===t.status&&(this.attendInfo=t.data.attendList,console.log(t.data.attendList)),!this.attendInfo[0].outTime&&"PM"===this.attendInfo[0].attendCode)return alert("PM 작업중!"),void(this.attendType="out");if(this.attendInfo[1].inTime&&this.attendInfo[1].outTime)return void alert("근무종료됨");this.attendInfo[1].inTime?(this.attendType="out",alert("퇴근하기 버튼 활성화!")):(this.attendType="in",alert("출근하기 버튼 활성화!"))}catch(t){console.log(t)}},computed:{getTime(){return this.$moment().format("HH:mm:ss")},getDay(){return t=>this.$moment().add("days",t).format("DD\n일")}},methods:{setLocationInfo(t){this.locationInfo.circleIn=t.circleIn,this.locationInfo.locCode=t.locCode},async attend(t){try{let a={email:"it1713@gsitm.com",attendDate:this.$moment().format("YYMMDD"),attendCode:"A01"};if("in"===t?(a.inTime=this.$moment().format("HHmmss"),a.locationCode=this.locationInfo.locCode):a.outTime=this.$moment().format("HHmmss"),"in"===t&&this.locationInfo.circleIn||"out"===t){const t=await this.$axios.post("/attend",a);200===t.status&&this.$router.go()}else"in"!==t||this.locationInfo.circleIn||alert("현재 위치가 회사 근처가 아닙니다 위치를 확인해주세요!")}catch(a){console.log(JSON.stringify(a))}}}},c=e,l=o(3736),r=(0,l.Z)(c,s,i,!1,null,null,null),d=r.exports}}]);
//# sourceMappingURL=613.3924e0d6.js.map